---
title: "Amari Cooper:"
date: 2020-06-01
tags: [analytics, web scraping, visualizations]
header:
  excerpt: "A Disappearing Act?"
  image: "/images/amari_rex.png"
mathjax: "true"
---

A few weeks ago on ESPN’s morning show “Get Up”, the often outspoken Rex Ryan, commented on the Cowboys signing Amari Cooper to a 5 year $100 million contract. Needless to say, he was not in favor of it.
“To me, this is biggest **disappearing act** in the National Football League,” Ryan said of Cooper. “He doesn’t show up on the road, he doesn’t show up — when the competition’s good, when he’s up against the top corners, that guy disappears.”
Rex went on to call Cooper a “turd”, which was particularly [headline grabbing](https://sports.yahoo.com/rex-ryan-goes-too-far-calls-amari-cooper-a-turd-154836759.html).

While I think most football fans would agree “turd” is a disrespectful exaggeration of Cooper, I wanted to dive deeper into Cooper’s performance and see if Rex had a point. In order to conduct such an analysis, I used data from the [nflscrapR repository](https://github.com/ryurko/nflscrapR-data) and focused on expected yards added as the main metric to judge performance. Here are some of the comparisons that I looked to quantify:
* Beginning vs end of the Season
* Home vs road
* Early in games vs late in games
* vs top cornerbacks
The code for this analysis can be found in this [Jupyter Notebook](https://github.com/mtodisco10/amari/blob/master/Amari_EDA.ipynb).
This post was also published on [The Sports Scientist](https://medium.com/the-sports-scientist/amari-cooper-a-disappearing-act-13856d15dd9a) section on Medium.

## Monthly Performance
The below graph plots average Expected Points Added (EPA) per game by month.

<img src="{{ site.url }}{{ site.baseurl }}/images/output_10_1.png" alt="Monthly EPA">


There is a pretty obvious decline as the season move along. Cooper puts up big numbers in September and October, but his EPA per game decreases as we get closer to the playoffs. And December has been his worse month (for both Dallas and Oakland), posting negative EPA.
Home vs Road Performance
The boxplots below shows each games EPA broken out by wether or not Cooper was playing at home or on the road.

<img src="{{ site.url }}{{ site.baseurl }}/images/output_12_1.png" alt="Home vs Road EPA">


#### Avg EPA per Quarter


```python
#filter out overtime
amari_stats_per_game_qtr = amari_stats_per_game_qtr.loc[amari_stats_per_game_qtr.qtr < 5]

plt.figure(figsize=(10,6))
sns.boxplot(x='qtr', y='epa', data=amari_stats_per_game_qtr, color = 'green')
```








<img src="{{ site.url }}{{ site.baseurl }}/images/output_14_1.png" alt="EPA per Quarter">


#### EPA per Quarter & Home v Road


```python
sns.heatmap(amari_stats_per_game_qtr.groupby(['qtr', 'amari_home'], as_index=False)['epa'].mean() \
    .pivot('qtr', 'amari_home', 'epa'), annot = True)
```








<img src="{{ site.url }}{{ site.baseurl }}/images/output_16_1.png" alt="EPA per Quarter & Home v Road">


#### vs Top Corners

`https://bleacherreport.com/articles/2782436-ranking-the-nfls-best-shutdown-cornerbacks`

Amari has played against 8 of the 10 corners on the list


```python
corner_lst = ['M.Peters','A.Bouye','C.Hayward','M.Lattimore','D.Slay','A.Talib','T.White',]

corner_game_ids = amari_pbp.loc[amari_pbp.pass_defense_1_player_name.isin(corner_lst), 'game_id'].unique()

amari_stats_per_game['top_corner'] = np.where(amari_stats_per_game['game_id'].isin(corner_game_ids), 'Y', 'N')

amari_stats_per_game.groupby(['top_corner'], as_index=False)['epa'].mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>top_corner</th>
      <th>epa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>N</td>
      <td>2.301360</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Y</td>
      <td>-0.738198</td>
    </tr>
  </tbody>
</table>
</div>



## Scrape Weather Data


```python
def request_data(url):
    page = requests.get(url)
    soup = BeautifulSoup(page.text, 'html.parser')
    
    return soup

def get_team_data(bs_data):
    teams = bs_data.find_all(class_="team-name text-center")

    away_teams = []
    home_teams = []

    for i, v in enumerate(teams):
        if i % 2 == 0:
            away_teams.append(teams[i].find('a').contents[0])
        else:
            home_teams.append(teams[i].find('a').contents[0])
            
    return away_teams, home_teams

def get_weather_data(bs_data):
    games = bs_data.find_all('tr')

    weather_lst = []
    for i, v in enumerate(games):
        #skip header
        if i > 0:
            game_details = games[i].find_all(class_='text-center')

            forecast = game_details[5].contents[0]

            weather_lst.append(' '.join(forecast.split()))
            
    return weather_lst

weather_lst = []

for season in seasons:
    print(f'Scraping Weather Data for the {season} Season')
    for week in weeks:
        request_url = f'{weather_url}{season}/week-{week}'
        soup = request_data(request_url)
        
        away_teams, home_teams = get_team_data(soup)
        
        weather = get_weather_data(soup)
        
        weather_df = pd.DataFrame({'away_tm': away_teams,
                                   'home_tm': home_teams,
                                   'weather': weather,
                                  })
        
        weather_df['year'] = season
        weather_df['week'] = week
        
        weather_lst.append(weather_df)
        
full_weather_df = pd.concat(weather_lst).reset_index(drop=True)

coop_weather_df = full_weather_df.loc[(full_weather_df.away_tm.isin(['Cowboys','Raiders'])) |
                                      (full_weather_df.home_tm.isin(['Cowboys','Raiders']))]

amari_pbp = amari_pbp.replace('SD', 'LAC')

coop_weather_df['away_team'] = coop_weather_df['away_tm'].apply(lambda x: team_map[x])
coop_weather_df['home_team'] = coop_weather_df['home_tm'].apply(lambda x: team_map[x])

merged_coop_df = amari_pbp.merge(coop_weather_df, how = 'left', on = ['away_team', 'home_team', 'year'])

merged_coop_df['temp'] = np.where(merged_coop_df.weather == 'DOME',
                                  -999,
                                  merged_coop_df.weather.str.split('f').str[0]).astype(int)
```

    Scraping Weather Data for the 2015 Season
    Scraping Weather Data for the 2016 Season
    Scraping Weather Data for the 2017 Season
    Scraping Weather Data for the 2018 Season
    Scraping Weather Data for the 2019 Season


## Explore Performance by Game Temperature


```python
merged_coop_df['temp_bin'] = np.where(merged_coop_df.temp < 50, "<50",
                                      np.where(merged_coop_df.temp < 75,'50-75',
                                      np.where(merged_coop_df.temp >= 75, '>=75', 'NO TEMP')))

temp_bin_df = merged_coop_df.groupby(['temp_bin'], as_index = False)['game_id',] \
    .agg(pd.Series.nunique) \
    .merge(merged_coop_df.groupby(['temp_bin'], as_index = False)['yards_gained',]
           .agg(np.sum), on = 'temp_bin')

temp_bin_df['yards_per_game'] = temp_bin_df['yards_gained'] / temp_bin_df['game_id']

temp_bin_df.columns = ['temperature', 'games', 'total_yards', 'yards_per_game']

temp_bin_df.yards_per_game = temp_bin_df.yards_per_game.round(1)

temp_bin_df['total_yards'] = temp_bin_df.apply(lambda x: "{:,}".format(x['total_yards']), axis=1)
temp_bin_df.sort_values('yards_per_game')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temperature</th>
      <th>games</th>
      <th>total_yards</th>
      <th>yards_per_game</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>&lt;50</td>
      <td>21</td>
      <td>1,047</td>
      <td>49.9</td>
    </tr>
    <tr>
      <th>0</th>
      <td>50-75</td>
      <td>35</td>
      <td>2,280</td>
      <td>65.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&gt;=75</td>
      <td>19</td>
      <td>1,713</td>
      <td>90.2</td>
    </tr>
  </tbody>
</table>
</div>



## Conclusion

it's clear Amari has not come up in the "clutch" so far in his young career.  That being said he is only 25 and has a ton of room to grow.  I look forward to seeing Amari improve and continue to bring value to a potent Cowboys offense.
